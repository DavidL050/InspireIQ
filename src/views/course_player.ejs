<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= course.name %> - InspireIQ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
</head>

<body class="bg-dark text-white">
    <header>
        <%- include('partials/navigation') %>
    </header>

    <div class="player-container">
        <div class="player-content">
            <!-- Video Section -->
            <div class="player-video-section">
                <div class="player-video-wrapper">
                    <% if (sections.length > 0 && sections[0].video_url) { %>
                        <iframe 
                            id="videoPlayer"
                            src="<%= sections[0].video_url %>"
                            title="Video del curso"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    <% } else { %>
                        <div class="alert alert-info">
                            No hay videos disponibles para este curso.
                        </div>
                    <% } %>
                </div>

                <!-- Course Details -->
                <div class="mt-4">
                    <h2 class="player-course-title"><%= course.name %></h2>
                    <hr>
                    <h4> Sección: <%= sections.length > 0 ? sections[0].title : '' %> </h4>
                    <h5 class="player-course-description">Descripción: <%= course.description %></h5>
                    <h6><strong>Creado:</strong> <%= new Date(course.creation_date).toLocaleDateString() %></h6>
                    <h6><strong>Idioma:</strong> <%= course.language %></h6>
                </div>


            </div>

            <!-- Course Content Sidebar -->
            <div class="player-sidebar">
                <div class="player-sidebar-header">
                    <h5>Contenido del curso</h5>
                    <button type="button" class="player-close-btn">&times;</button>
                </div>

                <div class="player-accordion" id="courseAccordion">
                    <% sections.forEach((section, index) => { %>
                        <div class="player-accordion-item mb-2" data-section-id="<%= section.section_id %>">
                            <div class="player-section-header d-flex justify-content-between align-items-center p-3">
                                <button 
                                    class="btn btn-link text-white text-decoration-none video-selector w-100 text-start"
                                    data-video-url="<%= section.video_url %>"
                                    data-section-title="<%= section.title %>"
                                    onclick="changeVideo(this)">
                                    <%= section.title %>
                                </button>
                            </div>
                        </div>
                    <% }); %>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        function changeVideo(button) {
            // Actualizar el video
            const videoUrl = button.getAttribute('data-video-url');
            const sectionTitle = button.getAttribute('data-section-title');
            const videoPlayer = document.getElementById('videoPlayer');
            const titleElement = document.getElementById('currentSectionTitle');

            if (videoUrl) {
                videoPlayer.src = videoUrl;
                titleElement.textContent = sectionTitle;

                // Remover clase activa de todos los botones
                document.querySelectorAll('.video-selector').forEach(btn => {
                    btn.parentElement.classList.remove('active-section');
                });

                // Agregar clase activa al botón seleccionado
                button.parentElement.classList.add('active-section');
            }
        }
    </script>

<%- include('partials/footer') %>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</body>


</html>